<DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<link rel="stylesheet" href="css/bootswatched/bootstrap-swatched-darkly.min.css" />
		<!-- <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"> -->
		<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
		<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
		
		<script>    
			$(document).ready(function () {
				//start from the top 
				let today = new Date();
				let weekBefore = new Date();
				weekBefore.setDate(today.getDate() - 7);
				generateWeek(weekBefore);
				generateWeek(today);

				//write four more weeks
				for (let i = 7; i <= 35; i = i + 7) {
					//new date should be today.
					let loopWeek = new Date();
					loopWeek.setDate(loopWeek.getDate() + i);
					console.log('in loop date loopweek:', loopWeek);
					console.log('today var', today);
					generateWeek(loopWeek);
				}

			});
			
			var calendaryId = "primaryCalendar";

			function generateWeek(weekDate) {
				let currentWeek = document.createElement('div');
				let currentDate = startDate = startOfWeek(weekDate);
				//console.log('(just ensuring i can map the variable twice) the current date', currentDate);
				currentWeek.className = "row week";
				for (let i = 0; i < 7; i++) {
					let currentDay = document.createElement('div');
					currentDay.className = "col day";
					//currentDay.id = 'cd-' + currentDate.getMonth() + '-' + currenDate.getDay();
					let span = document.createElement("span");
					span.innerHTML = currentDate.getDate();
					//add another day (which apparently has some bugs?)
					//https://stackoverflow.com/questions/3818193/how-to-add-number-of-days-to-todays-date/20468397#20468397
					currentDate = new Date(currentDate.getFullYear(), currentDate.getMonth(), currentDate.getDate() + 1);
					//if ((weekDate.getDay() - 1) == i ) {
					//    span.className =  " bold";
					//}
					currentDay.append(span);
					currentWeek.append(currentDay);
				}

				$('#' + calendaryId).append(currentWeek);
			}
			//https://www.w3resource.com/javascript-exercises/javascript-date-exercise-50.php
			function startOfWeek(inDate) {
				//changed this from 1 to zero to ensure that the days start on Sunday
				var diff = inDate.getDate() - inDate.getDay() + (inDate.getDay() === 0 ? -7 : 0);
				return new Date(inDate.setDate(diff));
			}

			//non functional yet..
			function checkIfNewMonth(inDate) {
				let startWeek = startOfWeek(inDate);
				let endDate = new Date();
				endDate.setDate(startWeek.getDate() + 7);
				return endDate.getMonth() !== startWeek.getMonth();
			}

		</script>
		<style>
			.week {
				border: 1px solid green;
			}

			.day {
				border: 1px solid red;
			}

			.bold{
				font-weight: bold;
				color: green;
			}
		</style>
	</head>
	<body>
		<div>Calendar</div>
		<div id="primaryCalendar"></div>
	</body>
</html>